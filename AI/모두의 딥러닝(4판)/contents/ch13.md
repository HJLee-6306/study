# 13장 모델의 성능 검증하기


[<img src="https://raw.githubusercontent.com/taehojo/taehojo.github.io/master/assets/images/linktocolab.png" align="left"/> ](https://colab.research.google.com/github/taehojo/deeplearning_4th/blob/master/colab/ch13-colab.ipynb)


##  데이터의 확인과 예측 실행


```python
import pandas as pd

# 데이터 입력
df = pd.read_csv('./data/sonar3.csv', header=None)

# 첫 5줄을 봅니다. 
df.head()
```


**출력 결과:**


<div class="output_html">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>51</th>
      <th>52</th>
      <th>53</th>
      <th>54</th>
      <th>55</th>
      <th>56</th>
      <th>57</th>
      <th>58</th>
      <th>59</th>
      <th>60</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0200</td>
      <td>0.0371</td>
      <td>0.0428</td>
      <td>0.0207</td>
      <td>0.0954</td>
      <td>0.0986</td>
      <td>0.1539</td>
      <td>0.1601</td>
      <td>0.3109</td>
      <td>0.2111</td>
      <td>...</td>
      <td>0.0027</td>
      <td>0.0065</td>
      <td>0.0159</td>
      <td>0.0072</td>
      <td>0.0167</td>
      <td>0.0180</td>
      <td>0.0084</td>
      <td>0.0090</td>
      <td>0.0032</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0453</td>
      <td>0.0523</td>
      <td>0.0843</td>
      <td>0.0689</td>
      <td>0.1183</td>
      <td>0.2583</td>
      <td>0.2156</td>
      <td>0.3481</td>
      <td>0.3337</td>
      <td>0.2872</td>
      <td>...</td>
      <td>0.0084</td>
      <td>0.0089</td>
      <td>0.0048</td>
      <td>0.0094</td>
      <td>0.0191</td>
      <td>0.0140</td>
      <td>0.0049</td>
      <td>0.0052</td>
      <td>0.0044</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0262</td>
      <td>0.0582</td>
      <td>0.1099</td>
      <td>0.1083</td>
      <td>0.0974</td>
      <td>0.2280</td>
      <td>0.2431</td>
      <td>0.3771</td>
      <td>0.5598</td>
      <td>0.6194</td>
      <td>...</td>
      <td>0.0232</td>
      <td>0.0166</td>
      <td>0.0095</td>
      <td>0.0180</td>
      <td>0.0244</td>
      <td>0.0316</td>
      <td>0.0164</td>
      <td>0.0095</td>
      <td>0.0078</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0100</td>
      <td>0.0171</td>
      <td>0.0623</td>
      <td>0.0205</td>
      <td>0.0205</td>
      <td>0.0368</td>
      <td>0.1098</td>
      <td>0.1276</td>
      <td>0.0598</td>
      <td>0.1264</td>
      <td>...</td>
      <td>0.0121</td>
      <td>0.0036</td>
      <td>0.0150</td>
      <td>0.0085</td>
      <td>0.0073</td>
      <td>0.0050</td>
      <td>0.0044</td>
      <td>0.0040</td>
      <td>0.0117</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0762</td>
      <td>0.0666</td>
      <td>0.0481</td>
      <td>0.0394</td>
      <td>0.0590</td>
      <td>0.0649</td>
      <td>0.1209</td>
      <td>0.2467</td>
      <td>0.3564</td>
      <td>0.4459</td>
      <td>...</td>
      <td>0.0031</td>
      <td>0.0054</td>
      <td>0.0105</td>
      <td>0.0110</td>
      <td>0.0015</td>
      <td>0.0072</td>
      <td>0.0048</td>
      <td>0.0107</td>
      <td>0.0094</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 61 columns</p>
</div>
</div>


```python
# 일반 암석(0)과 광석(1)이 몇 개 있는지 확인합니다.
df[60].value_counts()
```


**출력 결과:**


```
60
1    111
0     97
Name: count, dtype: int64
```


```python
import sys
print(sys.executable)
```


**출력 결과:**


```
C:\Users\taehj\anaconda3\envs\deep_learning\python.exe

```


```python
# 음파 관련 속성을 X로, 광물의 종류를 y로 저장합니다.
X = df.iloc[:,0:60]
y = df.iloc[:,60]
```


```python
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

# 모델을 설정합니다.
model = Sequential()
model.add(Dense(24,  input_dim=60, activation='relu'))
model.add(Dense(10, activation='relu'))
model.add(Dense(1, activation='sigmoid'))

# 모델을 컴파일합니다.
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])

# 모델을 실행합니다.
history=model.fit(X, y, epochs=200, batch_size=10)
```


**출력 결과:**


```
Epoch 1/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 1ms/step - accuracy: 0.4618 - loss: 0.6971   
Epoch 2/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.6545 - loss: 0.6808 
Epoch 3/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.5218 - loss: 0.6751 
Epoch 4/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.5398 - loss: 0.6763 
Epoch 5/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.6200 - loss: 0.6508 
Epoch 6/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.6797 - loss: 0.6456 
Epoch 7/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.6357 - loss: 0.6478 
Epoch 8/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.6944 - loss: 0.6179 
Epoch 9/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7442 - loss: 0.6137 
Epoch 10/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7661 - loss: 0.5935 
Epoch 11/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7969 - loss: 0.5673 
Epoch 12/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.7804 - loss: 0.5703 
Epoch 13/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.7400 - loss: 0.5768 
Epoch 14/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7633 - loss: 0.5451 
Epoch 15/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8070 - loss: 0.5306 
Epoch 16/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.7636 - loss: 0.5139 
Epoch 17/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7430 - loss: 0.5118 
Epoch 18/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8136 - loss: 0.4746 
Epoch 19/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7577 - loss: 0.4594 
Epoch 20/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7673 - loss: 0.4702 
Epoch 21/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7692 - loss: 0.4793 
Epoch 22/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.8132 - loss: 0.4568 
Epoch 23/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.7741 - loss: 0.4803 
Epoch 24/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8743 - loss: 0.3807 
Epoch 25/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7943 - loss: 0.4055 
Epoch 26/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8223 - loss: 0.4002 
Epoch 27/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7883 - loss: 0.4152 
Epoch 28/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8787 - loss: 0.3710 
Epoch 29/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7843 - loss: 0.4165 
Epoch 30/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8182 - loss: 0.4040 
Epoch 31/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7802 - loss: 0.4038 
Epoch 32/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8455 - loss: 0.3674 
Epoch 33/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8321 - loss: 0.3589 
Epoch 34/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8322 - loss: 0.3811 
Epoch 35/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.8495 - loss: 0.4108 
Epoch 36/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8648 - loss: 0.3707 
Epoch 37/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8218 - loss: 0.3169 
Epoch 38/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8554 - loss: 0.3317 
Epoch 39/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8490 - loss: 0.3609 
Epoch 40/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8595 - loss: 0.3388 
Epoch 41/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.8816 - loss: 0.3090 
Epoch 42/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8434 - loss: 0.3598 
Epoch 43/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8491 - loss: 0.3431 
Epoch 44/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8745 - loss: 0.2942 
Epoch 45/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8521 - loss: 0.3091 
Epoch 46/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8558 - loss: 0.3369 
Epoch 47/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.8205 - loss: 0.3299 
Epoch 48/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8769 - loss: 0.3104 
Epoch 49/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8690 - loss: 0.3159 
Epoch 50/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8649 - loss: 0.3180 
Epoch 51/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8917 - loss: 0.2932 
Epoch 52/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8672 - loss: 0.3033 
Epoch 53/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8266 - loss: 0.3477 
Epoch 54/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8420 - loss: 0.3052 
Epoch 55/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8715 - loss: 0.2727 
Epoch 56/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9172 - loss: 0.2680 
Epoch 57/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8688 - loss: 0.3068 
Epoch 58/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9052 - loss: 0.2901 
Epoch 59/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8830 - loss: 0.2627 
Epoch 60/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9035 - loss: 0.2494 
Epoch 61/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8379 - loss: 0.3178 
Epoch 62/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8958 - loss: 0.2520 
Epoch 63/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8711 - loss: 0.2980 
Epoch 64/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8872 - loss: 0.2647 
Epoch 65/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8999 - loss: 0.2614 
Epoch 66/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8878 - loss: 0.2934 
Epoch 67/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9219 - loss: 0.2349 
Epoch 68/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9076 - loss: 0.2557 
Epoch 69/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9142 - loss: 0.2299 
Epoch 70/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.8747 - loss: 0.2833 
Epoch 71/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9076 - loss: 0.2275 
Epoch 72/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9056 - loss: 0.2263 
Epoch 73/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9219 - loss: 0.2307 
Epoch 74/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8993 - loss: 0.2406 
Epoch 75/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8992 - loss: 0.2433 
Epoch 76/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9177 - loss: 0.2049 
Epoch 77/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9456 - loss: 0.1877 
Epoch 78/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8955 - loss: 0.2135 
Epoch 79/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9157 - loss: 0.2293 
Epoch 80/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9374 - loss: 0.2121 
Epoch 81/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9213 - loss: 0.2100 
Epoch 82/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9277 - loss: 0.2106 
Epoch 83/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9178 - loss: 0.1884 
Epoch 84/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9355 - loss: 0.2132 
Epoch 85/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9429 - loss: 0.1793 
Epoch 86/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8923 - loss: 0.2270 
Epoch 87/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9239 - loss: 0.2147 
Epoch 88/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8755 - loss: 0.2791 
Epoch 89/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9433 - loss: 0.2020 
Epoch 90/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9069 - loss: 0.2256 
Epoch 91/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9344 - loss: 0.2072 
Epoch 92/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9435 - loss: 0.1779 
Epoch 93/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9453 - loss: 0.2005 
Epoch 94/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9353 - loss: 0.1732 
Epoch 95/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9289 - loss: 0.2071 
Epoch 96/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9661 - loss: 0.1690 
Epoch 97/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9328 - loss: 0.1748 
Epoch 98/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9148 - loss: 0.1945 
Epoch 99/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9399 - loss: 0.1897 
Epoch 100/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9382 - loss: 0.1696 
Epoch 101/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9594 - loss: 0.1461 
Epoch 102/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9644 - loss: 0.1686 
Epoch 103/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9428 - loss: 0.1798 
Epoch 104/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9543 - loss: 0.1579 
Epoch 105/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9624 - loss: 0.1222 
Epoch 106/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9558 - loss: 0.1408 
Epoch 107/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9338 - loss: 0.1500 
Epoch 108/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9761 - loss: 0.1332 
Epoch 109/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9453 - loss: 0.1647 
Epoch 110/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9418 - loss: 0.1666 
Epoch 111/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9458 - loss: 0.1434 
Epoch 112/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9561 - loss: 0.1538 
Epoch 113/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9700 - loss: 0.1372 
Epoch 114/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9524 - loss: 0.1421 
Epoch 115/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9615 - loss: 0.1434 
Epoch 116/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9589 - loss: 0.1447 
Epoch 117/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9495 - loss: 0.1655 
Epoch 118/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9649 - loss: 0.1572 
Epoch 119/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9811 - loss: 0.1044 
Epoch 120/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9614 - loss: 0.1492 
Epoch 121/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9848 - loss: 0.1242 
Epoch 122/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9422 - loss: 0.1290 
Epoch 123/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9368 - loss: 0.1601 
Epoch 124/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9564 - loss: 0.1243 
Epoch 125/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9753 - loss: 0.1220 
Epoch 126/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9530 - loss: 0.1574 
Epoch 127/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9862 - loss: 0.1100 
Epoch 128/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9519 - loss: 0.1212 
Epoch 129/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9808 - loss: 0.1125 
Epoch 130/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9654 - loss: 0.1156 
Epoch 131/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9587 - loss: 0.1259 
Epoch 132/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9869 - loss: 0.0976 
Epoch 133/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9913 - loss: 0.0941 
Epoch 134/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9814 - loss: 0.1011 
Epoch 135/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9623 - loss: 0.1092 
Epoch 136/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9854 - loss: 0.0989 
Epoch 137/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9752 - loss: 0.0955 
Epoch 138/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9943 - loss: 0.0866 
Epoch 139/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9753 - loss: 0.1077 
Epoch 140/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9890 - loss: 0.0825 
Epoch 141/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9938 - loss: 0.0859 
Epoch 142/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9899 - loss: 0.0995 
Epoch 143/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9972 - loss: 0.0807 
Epoch 144/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9872 - loss: 0.0813 
Epoch 145/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9848 - loss: 0.0983 
Epoch 146/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9892 - loss: 0.1009 
Epoch 147/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9689 - loss: 0.0968 
Epoch 148/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9862 - loss: 0.0766 
Epoch 149/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9972 - loss: 0.0737 
Epoch 150/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9759 - loss: 0.0959 
Epoch 151/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9942 - loss: 0.0637 
Epoch 152/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9906 - loss: 0.0814 
Epoch 153/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9676 - loss: 0.0993 
Epoch 154/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9766 - loss: 0.1077 
Epoch 155/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9892 - loss: 0.0854 
Epoch 156/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9861 - loss: 0.0748 
Epoch 157/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9956 - loss: 0.0608 
Epoch 158/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9803 - loss: 0.0828 
Epoch 159/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9801 - loss: 0.0882 
Epoch 160/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9951 - loss: 0.0575 
Epoch 161/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9922 - loss: 0.0572 
Epoch 162/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9986 - loss: 0.0668 
Epoch 163/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9836 - loss: 0.0625 
Epoch 164/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9928 - loss: 0.0648 
Epoch 165/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9927 - loss: 0.0660 
Epoch 166/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9946 - loss: 0.0593 
Epoch 167/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9943 - loss: 0.0641 
Epoch 168/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9915 - loss: 0.0643 
Epoch 169/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9969 - loss: 0.0650 
Epoch 170/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9946 - loss: 0.0627 
Epoch 171/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9993 - loss: 0.0498 
Epoch 172/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9965 - loss: 0.0488 
Epoch 173/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9917 - loss: 0.0605 
Epoch 174/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9669 - loss: 0.0808 
Epoch 175/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9915 - loss: 0.0532 
Epoch 176/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9988 - loss: 0.0445 
Epoch 177/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9993 - loss: 0.0353 
Epoch 178/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9973 - loss: 0.0392 
Epoch 179/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9943 - loss: 0.0533 
Epoch 180/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9977 - loss: 0.0443 
Epoch 181/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9980 - loss: 0.0397 
Epoch 182/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9993 - loss: 0.0330 
Epoch 183/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9973 - loss: 0.0422 
Epoch 184/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9956 - loss: 0.0448 
Epoch 185/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9969 - loss: 0.0347 
Epoch 186/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9991 - loss: 0.0335 
Epoch 187/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9988 - loss: 0.0318 
Epoch 188/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.9983 - loss: 0.0400 
Epoch 189/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9878 - loss: 0.0508 
Epoch 190/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9921 - loss: 0.0431 
Epoch 191/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9983 - loss: 0.0307 
Epoch 192/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 1.0000 - loss: 0.0323 
Epoch 193/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9963 - loss: 0.0271 
Epoch 194/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9973 - loss: 0.0280 
Epoch 195/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9983 - loss: 0.0304 
Epoch 196/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9993 - loss: 0.0276 
Epoch 197/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 1.0000 - loss: 0.0365 
Epoch 198/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9965 - loss: 0.0402 
Epoch 199/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 1.0000 - loss: 0.0252 
Epoch 200/200
[1m21/21[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 1.0000 - loss: 0.0247 

```
```
21/21 [==============================] - 0s 2ms/step - loss: 0.1250 - accuracy: 0.9712
Epoch 84/200
21/21 [==============================] - 0s 2ms/step - loss: 0.1244 - accuracy: 0.9712
Epoch 85/200
21/21 [==============================] - 0s 3ms/step - loss: 0.1237 - accuracy: 0.9760
Epoch 86/200
21/21 [==============================] - 0s 3ms/step - loss: 0.1244 - accuracy: 0.9615
Epoch 87/200
21/21 [==============================] - 0s 3ms/step - loss: 0.1145 - accuracy: 0.9760
Epoch 88/200
21/21 [==============================] - 0s 2ms/step - loss: 0.1116 - accuracy: 0.9760
Epoch 89/200
21/21 [==============================] - 0s 2ms/step - loss: 0.1099 - accuracy: 0.9663
Epoch 90/200
21/21 [==============================] - 0s 2ms/step - loss: 0.1078 - accuracy: 0.9712
Epoch 91/200
21/21 [==============================] - 0s 3ms/step - loss: 0.1064 - accuracy: 0.9808
Epoch 92/200
21/21 [==============================] - 0s 2ms/step - loss: 0.1029 - accuracy: 0.9760
Epoch 93/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0983 - accuracy: 0.9808
Epoch 94/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0996 - accuracy: 0.9808
Epoch 95/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0952 - accuracy: 0.9856
Epoch 96/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0943 - accuracy: 0.9952
Epoch 97/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0900 - accuracy: 0.9856
Epoch 98/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0864 - accuracy: 0.9952
Epoch 99/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0845 - accuracy: 1.0000
Epoch 100/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0839 - accuracy: 0.9856
Epoch 101/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0797 - accuracy: 0.9808
Epoch 102/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0787 - accuracy: 0.9856
Epoch 103/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0820 - accuracy: 0.9952
Epoch 104/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0759 - accuracy: 0.9904
Epoch 105/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0772 - accuracy: 1.0000
Epoch 106/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0718 - accuracy: 0.9856
Epoch 107/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0687 - accuracy: 1.0000
Epoch 108/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0659 - accuracy: 0.9904
Epoch 109/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0646 - accuracy: 1.0000
Epoch 110/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0669 - accuracy: 0.9952
Epoch 111/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0620 - accuracy: 1.0000
Epoch 112/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0708 - accuracy: 0.9904
Epoch 113/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0612 - accuracy: 0.9952
Epoch 114/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0595 - accuracy: 0.9952
Epoch 115/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0585 - accuracy: 0.9952
Epoch 116/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0590 - accuracy: 0.9856
Epoch 117/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0529 - accuracy: 1.0000
Epoch 118/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0552 - accuracy: 1.0000
Epoch 119/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0500 - accuracy: 1.0000
Epoch 120/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0486 - accuracy: 0.9952
Epoch 121/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0506 - accuracy: 0.9952
Epoch 122/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0461 - accuracy: 1.0000
Epoch 123/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0464 - accuracy: 1.0000
Epoch 124/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0433 - accuracy: 1.0000
Epoch 125/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0434 - accuracy: 1.0000
Epoch 126/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0451 - accuracy: 1.0000
Epoch 127/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0450 - accuracy: 1.0000
Epoch 128/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0509 - accuracy: 0.9952
Epoch 129/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0508 - accuracy: 1.0000
Epoch 130/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0422 - accuracy: 1.0000
Epoch 131/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0396 - accuracy: 1.0000
Epoch 132/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0358 - accuracy: 1.0000
Epoch 133/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0350 - accuracy: 1.0000
Epoch 134/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0344 - accuracy: 1.0000
Epoch 135/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0347 - accuracy: 1.0000
Epoch 136/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0333 - accuracy: 1.0000
Epoch 137/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0325 - accuracy: 1.0000
Epoch 138/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0310 - accuracy: 1.0000
Epoch 139/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0296 - accuracy: 1.0000
Epoch 140/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0288 - accuracy: 1.0000
Epoch 141/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0292 - accuracy: 1.0000
Epoch 142/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0280 - accuracy: 1.0000
Epoch 143/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0284 - accuracy: 1.0000
Epoch 144/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0264 - accuracy: 1.0000
Epoch 145/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0270 - accuracy: 1.0000
Epoch 146/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0258 - accuracy: 1.0000
Epoch 147/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0245 - accuracy: 1.0000
Epoch 148/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0233 - accuracy: 1.0000
Epoch 149/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0254 - accuracy: 1.0000
Epoch 150/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0225 - accuracy: 1.0000
Epoch 151/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0225 - accuracy: 1.0000
Epoch 152/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0235 - accuracy: 1.0000
Epoch 153/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0218 - accuracy: 1.0000
Epoch 154/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0204 - accuracy: 1.0000
Epoch 155/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0199 - accuracy: 1.0000
Epoch 156/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0190 - accuracy: 1.0000
Epoch 157/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0212 - accuracy: 1.0000
Epoch 158/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0186 - accuracy: 1.0000
Epoch 159/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0176 - accuracy: 1.0000
Epoch 160/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0184 - accuracy: 1.0000
Epoch 161/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0183 - accuracy: 1.0000
Epoch 162/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0169 - accuracy: 1.0000
Epoch 163/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0169 - accuracy: 1.0000
Epoch 164/200

```
```
21/21 [==============================] - 0s 2ms/step - loss: 0.0175 - accuracy: 1.0000
Epoch 165/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0174 - accuracy: 1.0000
Epoch 166/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0161 - accuracy: 1.0000
Epoch 167/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0152 - accuracy: 1.0000
Epoch 168/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0141 - accuracy: 1.0000
Epoch 169/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0149 - accuracy: 1.0000
Epoch 170/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0139 - accuracy: 1.0000
Epoch 171/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0134 - accuracy: 1.0000
Epoch 172/200
21/21 [==============================] - 0s 3ms/step - loss: 0.0133 - accuracy: 1.0000
Epoch 173/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0130 - accuracy: 1.0000
Epoch 174/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0125 - accuracy: 1.0000
Epoch 175/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0123 - accuracy: 1.0000
Epoch 176/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0122 - accuracy: 1.0000
Epoch 177/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0132 - accuracy: 1.0000
Epoch 178/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0114 - accuracy: 1.0000
Epoch 179/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0113 - accuracy: 1.0000
Epoch 180/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0115 - accuracy: 1.0000
Epoch 181/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0114 - accuracy: 1.0000
Epoch 182/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0123 - accuracy: 1.0000
Epoch 183/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0102 - accuracy: 1.0000
Epoch 184/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0117 - accuracy: 1.0000
Epoch 185/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0123 - accuracy: 1.0000
Epoch 186/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0098 - accuracy: 1.0000
Epoch 187/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0098 - accuracy: 1.0000
Epoch 188/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0098 - accuracy: 1.0000
Epoch 189/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0096 - accuracy: 1.0000
Epoch 190/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0086 - accuracy: 1.0000
Epoch 191/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0090 - accuracy: 1.0000
Epoch 192/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0085 - accuracy: 1.0000
Epoch 193/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0082 - accuracy: 1.0000
Epoch 194/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0087 - accuracy: 1.0000
Epoch 195/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0081 - accuracy: 1.0000
Epoch 196/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0080 - accuracy: 1.0000
Epoch 197/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0073 - accuracy: 1.0000
Epoch 198/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0077 - accuracy: 1.0000
Epoch 199/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0073 - accuracy: 1.0000
Epoch 200/200
21/21 [==============================] - 0s 2ms/step - loss: 0.0073 - accuracy: 1.0000

```


## 3. 학습셋과 테스트셋


```python
# 사이킷런 라이브러리를 설치하는 부분입니다. 처음 설치한다면 아래 #를 삭제하고 실행하세요.
#!pip install scikit-learn
```


```python
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from sklearn.model_selection import train_test_split

import pandas as pd
```


```python
# 데이터를 입력합니다.
df = pd.read_csv('./data/sonar3.csv', header=None)
```


```python
# 음파 관련 속성을 X로, 광물의 종류를 y로 저장합니다.
X = df.iloc[:,0:60]
y = df.iloc[:,60]
```


```python
# 학습 셋과 테스트 셋을 구분합니다.
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, shuffle=True)
```


```python
# 모델을 설정합니다.
model = Sequential()
model.add(Dense(24,  input_dim=60, activation='relu'))
model.add(Dense(10, activation='relu'))
model.add(Dense(1, activation='sigmoid'))

# 모델을 컴파일합니다.
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])

# 모델을 실행합니다.
history=model.fit(X_train, y_train, epochs=200, batch_size=10)
```


**출력 결과:**


```
Epoch 1/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 2ms/step - accuracy: 0.4420 - loss: 0.6952  
Epoch 2/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.5456 - loss: 0.6846 
Epoch 3/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.6544 - loss: 0.6631 
Epoch 4/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7484 - loss: 0.6504 
Epoch 5/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7083 - loss: 0.6461 
Epoch 6/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7429 - loss: 0.6317 
Epoch 7/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7200 - loss: 0.6221 
Epoch 8/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7638 - loss: 0.6049 
Epoch 9/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7808 - loss: 0.5822 
Epoch 10/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7309 - loss: 0.6032 
Epoch 11/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8489 - loss: 0.5712 
Epoch 12/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7728 - loss: 0.5771 
Epoch 13/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8474 - loss: 0.5494 
Epoch 14/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7824 - loss: 0.5596 
Epoch 15/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7950 - loss: 0.5424 
Epoch 16/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8084 - loss: 0.5229 
Epoch 17/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7849 - loss: 0.5466 
Epoch 18/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7848 - loss: 0.5361 
Epoch 19/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8229 - loss: 0.4891 
Epoch 20/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7606 - loss: 0.5070 
Epoch 21/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8207 - loss: 0.4881 
Epoch 22/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7682 - loss: 0.5204 
Epoch 23/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7796 - loss: 0.5029 
Epoch 24/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7979 - loss: 0.4713 
Epoch 25/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7837 - loss: 0.4726 
Epoch 26/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7439 - loss: 0.5040 
Epoch 27/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7685 - loss: 0.4806 
Epoch 28/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7985 - loss: 0.4581 
Epoch 29/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8179 - loss: 0.4582 
Epoch 30/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.7896 - loss: 0.4475 
Epoch 31/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8031 - loss: 0.4615 
Epoch 32/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.7943 - loss: 0.4688 
Epoch 33/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8637 - loss: 0.4085 
Epoch 34/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8328 - loss: 0.4072 
Epoch 35/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8118 - loss: 0.4587 
Epoch 36/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8324 - loss: 0.4117 
Epoch 37/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8023 - loss: 0.4454 
Epoch 38/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8643 - loss: 0.3591 
Epoch 39/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8935 - loss: 0.3667 
Epoch 40/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8417 - loss: 0.4117 
Epoch 41/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8748 - loss: 0.3567 
Epoch 42/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8175 - loss: 0.4018 
Epoch 43/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8739 - loss: 0.3686 
Epoch 44/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8320 - loss: 0.4251 
Epoch 45/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8475 - loss: 0.3741 
Epoch 46/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8530 - loss: 0.3359 
Epoch 47/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8772 - loss: 0.3335 
Epoch 48/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8909 - loss: 0.3668 
Epoch 49/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8779 - loss: 0.3329 
Epoch 50/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8707 - loss: 0.3437 
Epoch 51/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8531 - loss: 0.3628 
Epoch 52/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8013 - loss: 0.3827 
Epoch 53/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8635 - loss: 0.3742 
Epoch 54/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9000 - loss: 0.3105 
Epoch 55/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8698 - loss: 0.3421 
Epoch 56/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8906 - loss: 0.3062 
Epoch 57/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8823 - loss: 0.3318 
Epoch 58/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8659 - loss: 0.3359 
Epoch 59/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8978 - loss: 0.3220 
Epoch 60/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8126 - loss: 0.3885 
Epoch 61/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9272 - loss: 0.2741 
Epoch 62/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9005 - loss: 0.2818 
Epoch 63/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8681 - loss: 0.2950 
Epoch 64/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8672 - loss: 0.2969 
Epoch 65/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8837 - loss: 0.3471 
Epoch 66/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9075 - loss: 0.2703 
Epoch 67/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.8929 - loss: 0.2783 
Epoch 68/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9242 - loss: 0.2689 
Epoch 69/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.8923 - loss: 0.2580 
Epoch 70/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8599 - loss: 0.3381 
Epoch 71/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9102 - loss: 0.2788 
Epoch 72/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8842 - loss: 0.2966 
Epoch 73/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8920 - loss: 0.2696 
Epoch 74/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8559 - loss: 0.2989 
Epoch 75/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8894 - loss: 0.2929 
Epoch 76/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.8847 - loss: 0.3106 
Epoch 77/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8843 - loss: 0.2610 
Epoch 78/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8995 - loss: 0.2753 
Epoch 79/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8762 - loss: 0.2881 
Epoch 80/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8991 - loss: 0.2512 
Epoch 81/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8945 - loss: 0.2988 
Epoch 82/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8959 - loss: 0.2398 
Epoch 83/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9179 - loss: 0.2811 
Epoch 84/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9531 - loss: 0.2316 
Epoch 85/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9081 - loss: 0.2711 
Epoch 86/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8787 - loss: 0.2779 
Epoch 87/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9489 - loss: 0.2153 
Epoch 88/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9088 - loss: 0.2368 
Epoch 89/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9363 - loss: 0.2676 
Epoch 90/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9223 - loss: 0.2526 
Epoch 91/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9228 - loss: 0.2326 
Epoch 92/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8824 - loss: 0.3036 
Epoch 93/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9484 - loss: 0.2061 
Epoch 94/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9244 - loss: 0.2174 
Epoch 95/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8907 - loss: 0.2692 
Epoch 96/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9049 - loss: 0.2373 
Epoch 97/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9190 - loss: 0.2276 
Epoch 98/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9273 - loss: 0.2464 
Epoch 99/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9230 - loss: 0.2293 
Epoch 100/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9193 - loss: 0.2563 
Epoch 101/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9326 - loss: 0.2673 
Epoch 102/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8982 - loss: 0.2779 
Epoch 103/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9155 - loss: 0.2802 
Epoch 104/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9706 - loss: 0.2011 
Epoch 105/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9454 - loss: 0.2205 
Epoch 106/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9191 - loss: 0.2342 
Epoch 107/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8977 - loss: 0.2583 
Epoch 108/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9398 - loss: 0.2267 
Epoch 109/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9574 - loss: 0.1794 
Epoch 110/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9514 - loss: 0.1940 
Epoch 111/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.8989 - loss: 0.2524 
Epoch 112/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9473 - loss: 0.2044 
Epoch 113/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9256 - loss: 0.2227 
Epoch 114/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9535 - loss: 0.1923 
Epoch 115/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9442 - loss: 0.2058 
Epoch 116/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9375 - loss: 0.2149 
Epoch 117/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9385 - loss: 0.1988 
Epoch 118/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9383 - loss: 0.2169 
Epoch 119/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9478 - loss: 0.1868 
Epoch 120/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9525 - loss: 0.2221 
Epoch 121/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9712 - loss: 0.1576 
Epoch 122/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9479 - loss: 0.2020 
Epoch 123/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9699 - loss: 0.1656 
Epoch 124/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9859 - loss: 0.1739 
Epoch 125/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9658 - loss: 0.1622 
Epoch 126/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9518 - loss: 0.1636 
Epoch 127/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9564 - loss: 0.1611 
Epoch 128/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9747 - loss: 0.1460 
Epoch 129/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9375 - loss: 0.2111 
Epoch 130/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9650 - loss: 0.1606 
Epoch 131/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9856 - loss: 0.1470 
Epoch 132/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9839 - loss: 0.1341 
Epoch 133/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9805 - loss: 0.1520 
Epoch 134/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9830 - loss: 0.1603 
Epoch 135/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9638 - loss: 0.1464 
Epoch 136/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9721 - loss: 0.1525 
Epoch 137/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9736 - loss: 0.1703 
Epoch 138/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9808 - loss: 0.1344 
Epoch 139/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9436 - loss: 0.1832 
Epoch 140/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9614 - loss: 0.1664 
Epoch 141/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9579 - loss: 0.1551 
Epoch 142/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9850 - loss: 0.1363 
Epoch 143/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9678 - loss: 0.1637 
Epoch 144/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9675 - loss: 0.1610 
Epoch 145/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9751 - loss: 0.1597 
Epoch 146/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9711 - loss: 0.1475 
Epoch 147/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9848 - loss: 0.1384 
Epoch 148/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9863 - loss: 0.1270 
Epoch 149/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9716 - loss: 0.1386 
Epoch 150/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9866 - loss: 0.1255 
Epoch 151/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9874 - loss: 0.1316 
Epoch 152/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9884 - loss: 0.1127 
Epoch 153/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9646 - loss: 0.1477 
Epoch 154/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9923 - loss: 0.1320 
Epoch 155/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9859 - loss: 0.1089 
Epoch 156/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9881 - loss: 0.1242 
Epoch 157/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9913 - loss: 0.1266 
Epoch 158/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9820 - loss: 0.1253 
Epoch 159/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9701 - loss: 0.1746 
Epoch 160/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9701 - loss: 0.1402 
Epoch 161/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9868 - loss: 0.1252 
Epoch 162/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9278 - loss: 0.1847 
Epoch 163/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9949 - loss: 0.1002 
Epoch 164/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9888 - loss: 0.1167 
Epoch 165/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9828 - loss: 0.1387 
Epoch 166/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9942 - loss: 0.1189 
Epoch 167/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9900 - loss: 0.1027 
Epoch 168/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9744 - loss: 0.1265 
Epoch 169/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9746 - loss: 0.1359 
Epoch 170/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9809 - loss: 0.1218 
Epoch 171/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9902 - loss: 0.1136 
Epoch 172/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9874 - loss: 0.1103 
Epoch 173/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9848 - loss: 0.0992 
Epoch 174/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9876 - loss: 0.0840 
Epoch 175/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9765 - loss: 0.0993 
Epoch 176/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9928 - loss: 0.0852 
Epoch 177/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9792 - loss: 0.1143 
Epoch 178/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9923 - loss: 0.0943 
Epoch 179/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9889 - loss: 0.1077 
Epoch 180/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9940 - loss: 0.0859 
Epoch 181/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9780 - loss: 0.1141 
Epoch 182/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9589 - loss: 0.1362 
Epoch 183/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9729 - loss: 0.1347 
Epoch 184/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9935 - loss: 0.0787 
Epoch 185/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9838 - loss: 0.1073 
Epoch 186/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9908 - loss: 0.0851 
Epoch 187/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9952 - loss: 0.0883 
Epoch 188/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9844 - loss: 0.1105 
Epoch 189/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9918 - loss: 0.0835 
Epoch 190/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9853 - loss: 0.0942 
Epoch 191/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9764 - loss: 0.1094 
Epoch 192/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9832 - loss: 0.1093 
Epoch 193/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9890 - loss: 0.0933 
Epoch 194/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.9983 - loss: 0.0745 
Epoch 195/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9869 - loss: 0.0918 
Epoch 196/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9908 - loss: 0.0904 
Epoch 197/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9816 - loss: 0.0880 
Epoch 198/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9937 - loss: 0.0840 
Epoch 199/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9880 - loss: 0.0875 
Epoch 200/200
[1m15/15[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.9828 - loss: 0.0886 

```


```python
# 모델을 테스트셋에 적용해 정확도를 구합니다. 
score=model.evaluate(X_test, y_test)
print('Test accuracy:', score[1])
```


**출력 결과:**


```
[1m2/2[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 17ms/step - accuracy: 0.7789 - loss: 0.5012
Test accuracy: 0.7777777910232544

```


## 4. 모델 저장과 재사용


```python
# 모델을 저장합니다. 
model.save('./data/model/my_model.keras', save_format='tf')
```


**출력 결과:**


```
WARNING:absl:The `save_format` argument is deprecated in Keras 3. We recommend removing this argument as it can be inferred from the file path. Received: save_format=tf

```


```python
from tensorflow.keras.models import Sequential, load_model
```


```python
# 테스트를 위해 조금 전 사용한 모델을 메모리에서 삭제합니다.
del model 
```


```python
# 모델을 새로 불러옵니다.
model = load_model('./data/model/my_model.keras') 

# 불러온 모델을 테스트셋에 적용해 정확도를 구합니다. 
score=model.evaluate(X_test, y_test)
print('Test accuracy:', score[1])
```


**출력 결과:**


```
[1m2/2[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 17ms/step - accuracy: 0.7789 - loss: 0.5012 
Test accuracy: 0.7777777910232544

```


## 5. k겹 교차 검증


```python
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from sklearn.model_selection import KFold
from sklearn.metrics import accuracy_score

import pandas as pd

# 데이터를 입력합니다.
df = pd.read_csv('./data/sonar3.csv', header=None)

# 음파 관련 속성을 X로, 광물의 종류를 y로 저장합니다.
X = df.iloc[:,0:60]
y = df.iloc[:,60]
```


```python
#몇 겹으로 나눌 것인지를 정합니다. 
k=5

#KFold 함수를 불러옵니다. 분할하기 전에 샘플이 치우치지 않도록 섞어 줍니다.
kfold = KFold(n_splits=k, shuffle=True)

#정확도가 채워질 빈 리스트를 준비합니다.
acc_score = []

def model_fn():
    model = Sequential() #딥러닝 모델의 구조를 시작합니다.
    model.add(Dense(24, input_dim=60, activation='relu'))
    model.add(Dense(10, activation='relu'))
    model.add(Dense(1, activation='sigmoid'))
    return model

#K겹 교차 검증을 이용해 k번의 학습을 실행합니다. 
for train_index , test_index in kfold.split(X):  # for문에 의해서 k번 반복합니다. spilt()에 의해 k개의 학습셋, 테스트셋으로 분리됩니다.
    X_train , X_test = X.iloc[train_index,:], X.iloc[test_index,:]  
    y_train , y_test = y.iloc[train_index], y.iloc[test_index]

    model = model_fn()
    model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
    history=model.fit(X_train, y_train, epochs=200, batch_size=10, verbose=0) 
    
    accuracy = model.evaluate(X_test, y_test)[1]  #정확도를 구합니다.
    acc_score.append(accuracy)  #정확도 리스트에 저장합니다.

#k번 실시된 정확도의 평균을 구합니다.
avg_acc_score = sum(acc_score)/k

#결과를 출력합니다.
print('정확도:', acc_score)
print('정확도 평균:', avg_acc_score)
```


**출력 결과:**


```
[1m2/2[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 15ms/step - accuracy: 0.7897 - loss: 0.6872
[1m2/2[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 22ms/step - accuracy: 0.9315 - loss: 0.1919
[1m2/2[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 19ms/step - accuracy: 0.8423 - loss: 0.6285 
[1m2/2[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 18ms/step - accuracy: 0.7703 - loss: 0.5063
[1m2/2[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 22ms/step - accuracy: 0.7599 - loss: 0.6241 
정확도: [0.8095238208770752, 0.9285714030265808, 0.8571428656578064, 0.7804877758026123, 0.7804877758026123]
정확도 평균: 0.8312427282333374

```


```python

```

